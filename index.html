<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ””</text></svg>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Toast Notifications</title>
    <style>
      body {
        margin: unset;
        min-height: 100dvh;
        place-content: center;
        justify-items: center;
      }

      button {
        touch-action: manipulation;
        user-select: none;
        -webkit-user-select: none;
      }

      /* toast-queue customization */
      [data-tq-part="popover"] {
        --toast-width: 380px;
        padding: 1.5rem;
      }

      [data-tq-part="popover"]:popover-open {
        overflow-block: auto;
        max-height: 100dvh;
      }

      [data-tq-part="group"] {
        gap: .6rem;
      }

      [data-tq-part="toast"] {
        display: flex;
        justify-content: space-between;
        padding: 1rem;
        background-color: Canvas;
        border: 1px solid #0000001a;
        border-radius: 1rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.102);
        position: relative;
      }

      [data-tq-part="content"] {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        flex: 1;
        gap: .5rem;
      }

      [data-tq-part="close-button"] {
        position: absolute;
        right: 100%;
        bottom: 100%;
        translate: 50% 50%;
        z-index: inherit;
        aspect-ratio: 1;
        border-radius: 100%;
        background-color: Canvas;
        border: 1px outset #0000001a;
        opacity: 0;
        transition: opacity .3s ease-in-out;
      }

      [data-tq-part="item"]:hover [data-tq-part="close-button"],
      [data-tq-part="item"]:focus-within [data-tq-part="close-button"] {
        opacity: 1;
      }

      .toast--error {
        background-color: hotpink;
      }
    </style>
  </head>
  <body>
    <main>
      <button data-action="add-toast">ðŸ””</button>
      <select id="toastPositionMenu" aria-label="Toast position">
        <option value="top start">top start</option>
        <option value="top center">top center</option>
        <option value="top end">top end</option>
        <option value="bottom start">bottom start</option>
        <option value="bottom center">bottom center</option>
        <option value="bottom end">bottom end</option>
      </select>
    </main>

    <script type="module">
      import { ToastQueue } from './src/index.js';
      // import stackPreset from './src/presets/stack/index.js';

      const toastPosition = localStorage.getItem('toast-position') || 'top center';

      window.toastQueue = new ToastQueue({
        // duration: 6000,
        position: toastPosition,
        root: document.body,
        // ...stackPreset
      });

      window.setToastPosition = (value) => {
        toastQueue.position = value;
        localStorage.setItem('toast-position', value);
      }

      toastPositionMenu.value = toastPosition;
      toastPositionMenu.addEventListener('change', event => {
        const selectedValue = event.target.value;
        setToastPosition(selectedValue);
      })

      document.addEventListener('click', event => {
        if (event.target.dataset.action === 'add-toast') {
          // event.preventDefault();

          toastQueue.add({
            title: 'Title',
            description: Date.now()
          }, {
            // className: 'toast toast--error',
            // dismissible: false,
            // actionLabel: 'Action',
            // onAction: () => console.log(Date.now())
          });
          return;
        }
      });

      document.addEventListener('click', event => {
        if (event.target.closest('[data-tq-dragging]')) return;
        if (event.target.closest('[data-tq-command]')) return;

        if (!event.target.closest('[data-tq-part="popover"]') && !toastQueue.viewMode) {
          toastQueue.viewMode = 'stacked';
          return;
        }

        if (event.target.closest('[data-tq-view-mode="stacked"]')) {
          toastQueue.viewMode = null;
          return;
        }
      })
    </script>
  </body>
</html>
