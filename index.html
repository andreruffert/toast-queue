<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ””</text></svg>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>toast-queue</title>
    <style>
      body {
        margin: unset;
        min-height: 100dvh;
        place-content: center;
        justify-items: center;
      }

      * {
        box-sizing: border-box;
      }

      button {
        touch-action: manipulation;
        user-select: none;
        -webkit-user-select: none;
      }

      /* toast-queue customization */
      toast-queue {
        width: 300px;
        padding: 1.5rem;
      }

      toast-queue:is(:popover-open) {
        overflow: visible;
        /* overflow-block: auto; */
        /* max-height: 100dvh; */
      }

      toast-queue [data-part="group"] {
        gap: .6rem;
      }

      toast-queue [data-part="toast"] {
        padding: 1rem;
        border: 1px solid #0000001a;
        border-radius: 1rem;
        box-shadow: 0 4px 12px rgb(0, 0, 0, 0.102);
        position: relative;
        gap: .5rem;
      }

      toast-queue [data-part="content"] {
        align-items: flex-start;
        flex: 1;
        gap: .3rem;
      }

      toast-queue [data-part="close-button"] {
        position: absolute;
        right: 100%;
        bottom: 100%;
        translate: 50% 50%;
        z-index: inherit;
        aspect-ratio: 1;
        border-radius: 100%;
        background-color: Canvas;
        border: 1px outset #0000001a;
        opacity: 0;
        transition: opacity .3s ease-in-out;
      }

      toast-queue [data-part="item"]:hover [data-part="close-button"],
      toast-queue [data-part="item"]:focus-within [data-part="close-button"] {
        opacity: 1;
      }

      toast-queue .my-toast {
        background-color: hotpink;
      }
    </style>
  </head>
  <body>
    <main>
      <button data-action="add-toast">ðŸ””</button>
      <select id="toastPlacementMenu" aria-label="Toast placement">
        <option value="top-start">top start</option>
        <option value="top-center">top center</option>
        <option value="top-end">top end</option>
        <option value="bottom-start">bottom start</option>
        <option value="bottom-center">bottom center</option>
        <option value="bottom-end">bottom end</option>
        <option value="center">center</option>
      </select>
    </main>

    <script type="module">
      import { ToastQueue } from './src/index.js';
      import preset from './src/presets/stack/index.js';
      import './src/presets/stack/style.css';
      // import './src/presets/minimal/style.css';

      const toastPlacement = localStorage.getItem('tq-placement') || 'top-center';

      window.toastQueue = new ToastQueue({
        pauseOnPageIdle: false,
        duration: null,
        placement: toastPlacement,
        ...preset
      });

      window.setToastPlacement = (value) => {
        toastQueue.placement = value;
        localStorage.setItem('tq-placement', value);
      }

      toastPlacementMenu.value = toastPlacement;
      toastPlacementMenu.addEventListener('change', event => {
        const selectedValue = event.target.value;
        setToastPlacement(selectedValue);
      })

      document.addEventListener('click', event => {
        if (event.target.dataset.action === 'add-toast') {
          // event.preventDefault();

          toastQueue.add(
            // 'Desc...',
            {
              title: 'Title',
              description: Date.now()
            },
            {
            // icon: 'â„¹ï¸',
            // className: 'my-toast',
            // dismissible: false,
            // duration: null,
            // action: {
            //   label: 'Action',
            //   onClick: () => console.log(Date.now())
            // },
          });
          return;
        }
      });

      document.addEventListener('click', (event) => {
        if (!event.target.closest('toast-queue') && !toastQueue.mode) {
          toastQueue.mode = 'stacked';
          toastQueue.resume();
          return;
        }

        if (event.target.closest('toast-queue[data-mode="stacked"]')) {
          toastQueue.mode = null;
          toastQueue.pause();
          return;
        }
      });
    </script>
  </body>
</html>
